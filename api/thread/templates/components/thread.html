<div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
    <p class="text-gray-800 mb-4">{{ thread.content }}</p>
  
    {% if thread.image %}
    <img
      src="{{ thread.image.url }}"
      alt="Thread Image"
      class="max-h-[96px] rounded-md object-cover opacity-70 blur-sm hover:filter-none hover:opacity-100 transition-all duration-300 ease-in-out" />
    {% endif %}
  
    <div class="flex justify-between mt-4">
      <div class="flex items-center gap-4">
        <button
          id="like-button-{{ thread.id }}"
          class="like-button text-blue-500 hover:text-blue-600 transition"
          onclick="toggleLike({{ thread.id }})">
          {{ thread.like_count }} Likes
        </button>
        <p>{{ thread.comment_count }} Comments</p>
      </div>
  
      {% if thread.author.id == user_id %}
      <div class="flex justify-end mt-4 gap-4">
        <button
          class="text-blue-500 hover:text-blue-600 transition"
          onclick="editThread({{ thread.id }}, '{{ content }}')">
          Edit
        </button>
        <button
          class="text-red-500 hover:text-red-600 transition"
          onclick="deleteThread({{ thread.id }})">
          Delete
        </button>
      </div>
      {% endif %}
    </div>
  </div>
  
  <script>
    function toggleLike(threadId) {
      const likeButton = document.getElementById(`like-button-${threadId}`);
      const originalText = likeButton.textContent;
      
      // Set the loading state
      likeButton.textContent = 'Liking...';
      likeButton.disabled = true;
  
      fetch(`like/${threadId}/`, {
        method: 'POST',
        headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'Content-Type': 'application/json',
        },
      })
        .then(response => response.json())
        .then(data => {
          // Update the button with the new like count
          likeButton.textContent = `${data.likes_count ?? 0} Likes`;
  
          // Change button color based on whether it's liked or not
          if (data.liked) {
            likeButton.classList.add('text-blue-600');
            likeButton.classList.remove('text-blue-500');
          } else {
            likeButton.classList.add('text-blue-500');
            likeButton.classList.remove('text-blue-600');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          likeButton.textContent = originalText; // Reset to original text in case of error
        })
        .finally(() => {
          // Remove loading state
          likeButton.disabled = false;
        });
    }
  </script>
  